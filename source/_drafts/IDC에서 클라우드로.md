---
title: IDC 에서 클라우드로
catalog: true
date: 2019-08-22 21:53:55
subtitle: 
header-img: "bg_computer.jpg"
tags: 
- Experience
catagories:
- AWS
---


무신사에서 인프라 환경이 IDC에서 AWS클라우드로 전환과정을 정리하였습니다.

### 왜 클라우드 환경인가?

[DevOps 시대가 요구하는 품질확보 방법](https://www.slideshare.net/arload/devops-124383318)

클라우드 서버에 장점인 Auto Scaling때문입니다.

회사 사업상 추석, 이벤트, 푸쉬발송 등 특정 이벤트에 사용자가 폭주로 평균 트래픽에 9배 이상이 서버 요청이 들어옵니다. 이때 IDC에서는 유리천장 즉, 수용 할 수 있는 한계치만 허용하고 그 이상 트래픽을 받을수 없어 사용자 입장에서는 사이트에 접근 할 수 없는 상황이 될 수도 있죠. 이는 사용자 이탈을 발생 시킬수 있으며 곧 매출에 영향을 미칠수 있습니다.

그래서 트래픽에 따라서 유연하게 서버를 scale out 하기 위해 AWS에서 서버를 운용하기로 하게 되었습니다.

블루그린, 레드블랙

AWS 이미지 생성 배포 방식, 코드만 배포

### 배포는 어떻게 이루어지는가

TODO 배포 프로세스 이미지 넣기

AWS에서 배포하는 방식이 2가지가 있습니다.

용어는 생각이 나지 않지만 이미지를 만들고 배포하는 방식, 코드만 인식해서 배포하는 방식 회사에서는 바뀐 파일만 인식하는 방식을 사용하게 되었습니다. 왜 그런지는 아래에서 설명하도록 하겠습니다.

### 이미지 배포 방식 AMI (Amazon Machine Image)

S3에 존재하는 artifact 를 Code Deploy가 이미지를 만들어 각 서버에 배포하는 방식입니다.

장점은 ...

단점은 배포하는 방식이 느리다는 것입니다.

### 변경된 파일만 배포하는 방식 (용어 넣기)

사내에서는 이 방식을 채택하게 되었습니다.

배포 속도를 높은것을 중요하게 생각하였기 때문입니다.

### 블루그린 배포

서버4대가 있다고 가정해보겠습니다. 

서비스 운영중에 서버를 내리고 그냥 배포하면 될까요?? 예를 들어 1대씩 죽이고 배포하다가 잘 못되면??

그래서 블루그린 방식이 있습니다.

새롭게 배포할 서버4대를 새로 구성해 놓고 거기에 배포하고 트래픽을 새로 만든 서버 4대에다가 보내는 것이죠

만약에 문제가 생긴다면 이전에 구성한 서버에다가 다시 트래픽을 보내는것이구요

### 레드블랙 배포

개념 조사 필요

회사에서는 레드블랙으로 배포 한다.